[
  {
    "id": "rk-ds01",
    "name": "get-load-balancers",
    "description": "get load balancers",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "args": false,
    "command": "kubectl get services --all-namespaces -o jsonpath='{range .items[?(@.spec.type==\"LoadBalancer\")]}{.status.loadBalancer.ingress[*].hostname}:{.spec.ports[*].port}{\"\\n\"}{end}'",
    "leading_to": ""
  },
  {
    "id": "rk-ds02",
    "name": "get-nodes-external-ip",
    "description": "get external IP's of all nodes",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "args": false,
    "command": "kubectl get nodes --all-namespaces -o jsonpath='{range .items[*].status.addresses[?(@.type==\"ExternalIP\")]}{.address}{\"\\n\"}{end}'",
    "leading_to": ""
  },
  {
    "id": "rk-ds03",
    "name": "get-k8s-api-config",
    "description": "get kubernetes API server config",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "args": false,
    "command": "POD_NAME=$(kubectl get pods --namespace kube-system | grep kube-apiserver | head -1 | awk '{print $1}') && [ ! -z $POD_NAME ] && kubectl get pod $POD_NAME --namespace kube-system",
    "leading_to": ""
  },
  {
    "id": "rk-ds04",
    "name": "get-k8s-api-args",
    "description": "get kubernetes API server container args",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "POD_NAME=$(kubectl get pods --namespace kube-system | grep kube-apiserver | head -1 | awk '{print $1}') && [ ! -z $POD_NAME ] && kubectl get pod $POD_NAME --namespace kube-system -o json | jq -r '.spec.containers | .[] |select(.name == \"kube-apiserver\")| .args'",
    "leading_to": ""
  },
  {
    "id": "rk-ds05",
    "name": "get-net-policy",
    "description": "get all network policies",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get networkpolicy --all-namespaces -o jsonpath='{range .items[*]}rule_name:{\" \"}{@.metadata.name}{\"\\n\"}namespace:{\" \"}{@.metadata.namespace}{\" \"}{\"\\n\"}rule:{\"\\n\"}{\"    \"}{@.spec.*}{\" \"}{\"\\n\"}{\"\\n\"}{end}'",
    "leading_to": ""
  },
  {
    "id": "rk-ds06",
    "name": "get-cluster-admins",
    "description": "get cluster admin role bindings",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get clusterrolebindings | grep \"ClusterRole/cluster-admin\"",
    "leading_to": "rk-ca06"
  },
  {
    "id": "rk-ds07",
    "name": "get-wide-secret-access",
    "description": "get cluster roles with secrets access",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get clusterroles -o json | jq -r '.items[] | select(.rules[].resources | index( \"secrets\" )|select(. != null)).metadata.name'",
    "leading_to": "rk-ca06"
  },
  {
    "id": "rk-ds08",
    "name": "get-namespaced-secret-access",
    "description": "get roles with secrets access",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get roles --all-namespaces -o json | jq -r '.items[] | select(.rules[].resources | index( \"secrets\" )|select(. != null)).metadata.name'",
    "leading_to": ""
  },
  {
    "id": "rk-ds09",
    "name": "get-wide-configmaps-access",
    "description": "get cluster roles with configmaps access",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get clusterroles -o json | jq -r '.items[] | select(.rules[].resources | index( \"configmaps\" )|select(. != null)).metadata.name'",
    "leading_to": ""
  },
  {
    "id": "rk-ds10",
    "name": "get-namespaced-configmaps-access",
    "description": "get roles with configmaps access",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get roles --all-namespaces -o json | jq -r '.items[] | select(.rules[].resources | index( \"configmaps\" )|select(. != null)).metadata.name'",
    "leading_to": ""
  },
  {
    "id": "rk-ds11",
    "name": "get-no-limit-containers",
    "description": "get pods with containers without resources limits",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get pods --all-namespaces -o json | jq -r '.items[].spec.containers[] | select(.resources.limits == null).name'",
    "leading_to": ""
  },
  {
    "id": "rk-ds12",
    "name": "get-container-images",
    "description": "get all containers images",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get pods --all-namespaces -o json | jq -r '.items[].spec.containers[].image' | sort | uniq",
    "leading_to": "rk-pr02"
  },
  {
    "id": "rk-ds13",
    "name": "get-clusterrole-wildcard",
    "description": "get cluster roles with wildcard resources",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get clusterroles -o json | jq -r '.items[] | select(.rules[].resources | index( \"*\" )|select(. != null)).metadata.name'",
    "leading_to": ""
  },
  {
    "id": "rk-ds14",
    "name": "get-roles-wildcard",
    "description": "get roles with wildcard resources",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get roles --all-namespaces -o json | jq -r '.items[] | select(.rules[].resources | index( \"*\" )|select(. != null)).metadata.name'",
    "leading_to": ""
  },
  {
    "id": "rk-ds15",
    "name": "get-pv-claims",
    "description": "get persistent volume claims",
    "tactic_id": "TA0007",
    "mitre_ref": "https://attack.mitre.org/tactics/TA0007/",
    "mode": "passive",
    "multistep": false,
    "args": false,
    "command": "kubectl get pvc --all-namespaces",
    "leading_to": ""
  }
]